# üí≥ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø–ª–∞—Ç—ã

## –î–ª—è –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

---

## üá∑üá∫ –í–∞—Ä–∏–∞–Ω—Ç 1: –ÆKassa (–î–ª—è –†–æ—Å—Å–∏–∏)

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:

- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ https://yookassa.ru
- [ ] –ü—Ä–æ–π—Ç–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é (–ò–ü/–û–û–û)
- [ ] –ü—Ä–∏–≤—è–∑–∞—Ç—å —Ä–∞—Å—á—ë—Ç–Ω—ã–π —Å—á—ë—Ç

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:

- [ ] `YUKASSA_SHOP_ID` - ID –≤–∞—à–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- [ ] `YUKASSA_SECRET_KEY` - –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á API

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook:

- [ ] –í –ÆKassa Dashboard ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å URL: `https://web-production-3f6e5.up.railway.app/api/payments/yukassa/webhook`
- [ ] –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: `payment.succeeded`, `payment.canceled`

### –î–æ–±–∞–≤–∏—Ç—å –≤ Railway:

```
Railway ‚Üí Variables ‚Üí Add Variable

YUKASSA_SHOP_ID=–≤–∞—à_shop_id
YUKASSA_SECRET_KEY=–≤–∞—à_secret_key
```

---

## üåç –í–∞—Ä–∏–∞–Ω—Ç 2: Stripe (–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏)

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:

- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ https://stripe.com
- [ ] –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∫–æ–º–ø–∞–Ω–∏–∏
- [ ] –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å payments

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:

- [ ] `STRIPE_SECRET_KEY` - –Ω–∞–π—Ç–∏ –≤ Dashboard ‚Üí Developers ‚Üí API Keys
- [ ] `STRIPE_WEBHOOK_SECRET` - —Å–æ–∑–¥–∞—Ç—å webhook –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–µ–∫—Ä–µ—Ç

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook:

- [ ] Stripe Dashboard ‚Üí Developers ‚Üí Webhooks
- [ ] Add endpoint: `https://web-production-3f6e5.up.railway.app/api/payments/stripe/webhook`
- [ ] –í—ã–±—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏—è: `checkout.session.completed`, `payment_intent.succeeded`
- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Signing secret (—ç—Ç–æ webhook secret)

### –î–æ–±–∞–≤–∏—Ç—å –≤ Railway:

```
Railway ‚Üí Variables ‚Üí Add Variable

STRIPE_SECRET_KEY=sk_live_–≤–∞—à_–∫–ª—é—á
STRIPE_WEBHOOK_SECRET=whsec_–≤–∞—à_webhook_—Å–µ–∫—Ä–µ—Ç
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Å—Ç–∞—Ä—Ç–∞:

**–ï—Å–ª–∏ –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–ª—å–∫–æ –≤ –†–æ—Å—Å–∏–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ÆKassa
- Stripe –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ

**–ï—Å–ª–∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏:**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–ø–ª–∞—Ç—ã –±—É–¥–µ—Ç –≤—ã–±–æ—Ä

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. **Test —Ä–µ–∂–∏–º:**
   - –ÆKassa –∏ Stripe –∏–º–µ—é—Ç test —Ä–µ–∂–∏–º—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test –∫–ª—é—á–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

2. **–†–µ–∞–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞:**
   - –°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ email —Å –∫–æ–¥–æ–º –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏—à—ë–ª

---

## üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–≤–∞–∂–Ω–æ!)

### –ë–µ–∑ email:
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∏—Ç –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- ‚ùå –ü—Ä–∏–¥—ë—Ç—Å—è –≤—Ä—É—á–Ω—É—é –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–¥—ã

### –° email:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gmail:

```
1. Google Account ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤–∫–ª—é—á–∏—Ç—å)
2. https://myaccount.google.com/apppasswords
3. –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è "–ü–æ—á—Ç–∞"
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å (16 —Å–∏–º–≤–æ–ª–æ–≤)

Railway ‚Üí Variables:
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=–≤–∞—à-email@gmail.com
SMTP_PASS=—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_app_password
SMTP_FROM="French Course Platform" <noreply@yoursite.com>
```

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

1. **Railway redeploy:** Deployments ‚Üí Redeploy
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:** –î–æ–ª–∂–Ω–æ –±—ã—Ç—å "‚úÖ Database connected"
3. **–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã:** `/payment.html`
4. **–í—ã–±—Ä–∞—Ç—å –º–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã:** –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Ñ–æ—Ä–º–∞
5. **–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å test –∫–∞—Ä—Ç—É

### Test –∫–∞—Ä—Ç—ã:

**–ÆKassa:**
- –ù–æ–º–µ—Ä: `5555555555554444`
- –°—Ä–æ–∫: –ª—é–±–æ–π –≤ –±—É–¥—É—â–µ–º
- CVC: `123`

**Stripe:**
- –ù–æ–º–µ—Ä: `4242424242424242`
- –°—Ä–æ–∫: –ª—é–±–æ–π –≤ –±—É–¥—É—â–µ–º
- CVC: –ª—é–±–æ–π

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### "Payment failed" –≤ –ª–æ–≥–∞—Ö:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º (test/live)

### Webhook –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
- ‚úÖ URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å HTTPS (Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ webhook –¥–æ–±–∞–≤–ª–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ webhook –≤ –ÆKassa/Stripe Dashboard

### Email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ App Password (–Ω–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä–æ–ª—å!)
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ 2FA –≤–∫–ª—é—á–µ–Ω–∞ –≤ Google
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway –Ω–∞ –æ—à–∏–±–∫–∏ SMTP

---

## üìã –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –∑–∞–≤—Ç—Ä–∞

1. ‚úÖ **–£—Ç—Ä–æ–º:** –ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–µ–æ –∏ —Å–æ–∑–¥–∞—Ç—å PDF
2. ‚úÖ **–î–Ω—ë–º:** –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ YouTube, –¥–æ–±–∞–≤–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫—É
3. ‚úÖ **–í–µ—á–µ—Ä–æ–º:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–ø–ª–∞—Ç—É:
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ÆKassa/Stripe
   - –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á–∏
   - –î–æ–±–∞–≤–∏—Ç—å –≤ Railway Variables
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhooks
   - –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂
4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–∫—É–ø–∫–∏ ‚Üí –¥–æ—Å—Ç—É–ø ‚Üí –æ–±—É—á–µ–Ω–∏–µ

---

## üöÄ –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å:** Railway logs (–æ—à–∏–±–∫–∏)
- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å:** Admin Panel (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:** –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–∫—É–ø–æ–∫

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:

- –ë—ã—Å—Ç—Ä–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ –≤—Å–µ –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- –°–æ–±–∏—Ä–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å

---

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É! üéâ**

–ö–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –æ–ø–ª–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ - –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏! üí∞
